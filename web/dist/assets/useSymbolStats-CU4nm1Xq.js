import{r,u as se,j as t,B as M,H as Z,b as Y,a2 as Q,c as ie,h as A,I as G,a0 as oe,Z as ce,Y as J,V as ae,G as le,a3 as F}from"./ui-CpDg7456.js";import{W as ue,P as de,Q as X}from"./charts-D8q9aCF-.js";import{A as H,g as te,f as fe}from"./index-BfGfRh_G.js";const he=s=>s.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),me=s=>s.replace(/^([A-Z])|[\s-_]+(\w)/g,(n,i,a)=>a?a.toUpperCase():i.toLowerCase()),K=s=>{const n=me(s);return n.charAt(0).toUpperCase()+n.slice(1)},re=(...s)=>s.filter((n,i,a)=>!!n&&n.trim()!==""&&a.indexOf(n)===i).join(" ").trim(),pe=s=>{for(const n in s)if(n.startsWith("aria-")||n==="role"||n==="title")return!0};var ye={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const xe=r.forwardRef(({color:s="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:a,className:l="",children:d,iconNode:u,...y},f)=>r.createElement("svg",{ref:f,...ye,width:n,height:n,stroke:s,strokeWidth:a?Number(i)*24/Number(n):i,className:re("lucide",l),...!d&&!pe(y)&&{"aria-hidden":"true"},...y},[...u.map(([o,c])=>r.createElement(o,c)),...Array.isArray(d)?d:[d]]));const ne=(s,n)=>{const i=r.forwardRef(({className:a,...l},d)=>r.createElement(xe,{ref:d,iconNode:n,className:re(`lucide-${he(K(s))}`,`lucide-${s}`,a),...l}));return i.displayName=K(s),i};const be=[["path",{d:"m10 10-6.157 6.162a2 2 0 0 0-.5.833l-1.322 4.36a.5.5 0 0 0 .622.624l4.358-1.323a2 2 0 0 0 .83-.5L14 13.982",key:"bjo8r8"}],["path",{d:"m12.829 7.172 4.359-4.346a1 1 0 1 1 3.986 3.986l-4.353 4.353",key:"16h5ne"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],ge=ne("pencil-off",be);const ve=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]],Se=ne("pencil",ve);function we(s){const{symbol:n,height:i=420,interval:a="1m",market:l="spot",orders:d=[],positions:u=[]}=s,{colorScheme:y}=se(),f=r.useRef(null),o=r.useRef(null),c=r.useRef(null),j=r.useRef(null),C=r.useRef([]),[h,O]=r.useState(!1),E=r.useRef(null),[S,P]=r.useState(null),z=r.useRef(u),x=r.useRef(null),m=r.useRef(null);r.useEffect(()=>{z.current=u},[u]);function V(e){switch(e){case"1m":return 60;case"15m":return 900;case"30m":return 1800;case"5m":return 300;case"1h":return 3600;case"2h":return 7200;case"4h":return 14400;case"6h":return 21600;case"1d":return 86400;case"2d":return 172800;case"1w":return 604800;default:return 60}}function I(e){return e.includes("_")?e:e.replace(/(USDT|USDC)$/i,"_$1")}function B(e){return e.replace("_","")}r.useEffect(()=>{if(o.current){const e=getComputedStyle(document.documentElement),p=e.getPropertyValue("--chart-text").trim()||"#808080",g=e.getPropertyValue("--chart-line").trim()||"#808080";o.current.applyOptions({layout:{textColor:p},crosshair:{vertLine:{color:g},horzLine:{color:g}}})}},[y]),r.useEffect(()=>{if(!f.current)return;if(o.current)try{o.current.remove()}catch{}let e=!1;const p=ue(f.current,{height:i,layout:{background:{color:"transparent"},textColor:"#808080"},grid:{horzLines:{visible:!1},vertLines:{visible:!1}},timeScale:{rightOffset:6,barSpacing:8},rightPriceScale:{borderVisible:!1},crosshair:{mode:0,vertLine:{width:1,color:"#808080",style:2,labelVisible:!0},horzLine:{width:1,color:"#808080",style:2,labelVisible:!0}},handleScroll:{mouseWheel:!0,pressedMouseMove:!0,horzTouchDrag:!0,vertTouchDrag:!0},handleScale:{mouseWheel:!0,pinch:!0,axisPressedMouseMove:!0}}),g=p.addSeries(de,{upColor:"#0BBA74",downColor:"#ff4761",borderUpColor:"#0BBA74",borderDownColor:"#ff4761",wickUpColor:"#0BBA74",wickDownColor:"#ff4761",priceLineStyle:1,priceLineWidth:2});(()=>{const W=getComputedStyle(document.documentElement),N=W.getPropertyValue("--chart-text").trim()||"#808080",q=W.getPropertyValue("--chart-line").trim()||"#808080";p.applyOptions({layout:{textColor:N},crosshair:{vertLine:{color:q},horzLine:{color:q}}})})(),o.current=p,c.current=g,C.current=[];const w=()=>{if(!e)try{p.applyOptions({width:f.current?.clientWidth??600})}catch{}};w();const v=new ResizeObserver(w);v.observe(f.current);const $=()=>{if(!c.current||!o.current)return;const W=z.current.find(N=>N.symbol===n||N.symbol===B(I(n)));if(W){const N=c.current.priceToCoordinate(parseFloat(W.entryPrice));N!==null&&(m.current===null||Math.abs(N-m.current)>.5)&&(P(N),m.current=N)}else m.current!==null&&(P(null),m.current=null)};p.timeScale().subscribeVisibleLogicalRangeChange($);let k;const R=()=>{$(),k=requestAnimationFrame(R)};return k=requestAnimationFrame(R),()=>{v.disconnect(),e=!0,cancelAnimationFrame(k);try{p.remove()}catch{}o.current=null,c.current=null,j.current=null,E.current=null,C.current=[]}},[i,n,y]),r.useEffect(()=>{if(!o.current||!c.current)return;const e=b=>{if(!h||!b?.point||!o.current||!c.current)return;const{x:w,y:v}=b.point,$=o.current.timeScale().coordinateToTime(w);if($==null)return;const k=typeof c.current.coordinateToPrice=="function"?c.current.coordinateToPrice(v):null;if(k==null)return;const R=Math.floor(Number($)),W=Number(k);if(!Number.isFinite(W))return;const N=E.current;if(!N)E.current={time:R,price:W},x.current||(x.current=o.current.addSeries(X,{color:"#0084ffff",lineWidth:1,lineStyle:1,lastValueVisible:!1,priceLineVisible:!1}));else{try{const q=o.current.addSeries(X,{color:"#0084ffff",lineWidth:2,lastValueVisible:!1,priceLineVisible:!1});q.setData([{time:N.time,value:N.price},{time:R,value:W}]),C.current.push(q)}catch{}x.current&&(o.current.removeSeries(x.current),x.current=null),E.current=null,O(!1)}};let p=null;const g=b=>{!h||!E.current||!x.current||!b?.point||(p&&cancelAnimationFrame(p),p=requestAnimationFrame(()=>{if(!o.current||!c.current||!x.current||!E.current)return;const{x:w,y:v}=b.point,$=o.current.timeScale().coordinateToTime(w),k=c.current.coordinateToPrice(v);if($!=null&&k!==null&&k!==void 0){const R=Math.floor(Number($));x.current.setData([{time:E.current.time,value:E.current.price},{time:R,value:Number(k)}])}}))};return o.current.subscribeClick(e),o.current.subscribeCrosshairMove(g),()=>{if(p&&cancelAnimationFrame(p),o.current&&(o.current.unsubscribeClick(e),o.current.unsubscribeCrosshairMove(g),x.current)){try{o.current.removeSeries(x.current)}catch{}x.current=null}}},[h]),r.useEffect(()=>{let e=!1;try{c.current&&c.current.setData([]),j.current=null}catch{}return(async()=>{try{const p="spot/klines",g=n.replace(/\s+/g,""),b=l==="futures"?B(I(g)):g,w=`${H}/api/markets/${p}?symbol=${b}&interval=${a}&limit=2000`,v=await fetch(w);if(!v.ok)return;const $=await v.json(),k=Array.isArray($)?$.map(R=>({time:R[0]/1e3,open:+R[1],high:+R[2],low:+R[3],close:+R[4]})):[];!e&&c.current&&(c.current.setData(k),j.current=k[k.length-1]??null,k.length>0&&o.current&&requestAnimationFrame(()=>{o.current&&o.current.timeScale().fitContent()}))}catch{}})(),()=>{e=!0}},[n,a,l,y]);const T=te(l,n),_=V(a);r.useEffect(()=>{if(!T||!c.current)return;const e=T.price,p=Math.floor(T.t/1e3),g=Math.floor(p/_)*_,b=j.current;if(!b||b.time<g){const w=a==="1m"&&T.open?T.open:b?.close??e,v={time:g,open:w,high:Math.max(w,e),low:Math.min(w,e),close:e};try{c.current.update(v)}catch{}j.current=v}else if(b.time===g){const w={time:b.time,open:b.open,high:Math.max(b.high,e),low:Math.min(b.low,e),close:e};try{c.current.update(w)}catch{}j.current=w}},[T,a,_]);const U=r.useRef([]),L=r.useRef([]);r.useEffect(()=>{c.current&&(U.current.forEach(e=>{try{c.current.removePriceLine(e)}catch{}}),L.current.forEach(e=>{try{c.current.removePriceLine(e)}catch{}}),U.current=[],L.current=[],d.forEach(e=>{const p=parseFloat(e.price);if(!(isNaN(p)||p<=0))try{const g=c.current.createPriceLine({price:p,color:e.side==="buy"?"#0BBA74":"#fe445c",lineWidth:1,lineStyle:2,axisLabelVisible:!0,title:`${e.side.toUpperCase()} ${e.quantity||e.amount||""}`});U.current.push(g)}catch{}}),u.forEach(e=>{const p=parseFloat(e.entryPrice);if(!isNaN(p)&&p>0)try{const v=c.current.createPriceLine({price:p,color:e.side==="long"?"#0BBA74":"#fe445c",lineWidth:1,lineStyle:2,axisLabelVisible:!0,title:`${e.side.charAt(0).toUpperCase()+e.side.slice(1)}`});L.current.push(v)}catch{}const g=parseFloat(e.liquidationPrice);if(!isNaN(g)&&g>0){const v=c.current.createPriceLine({price:g,color:"#fe445c",lineWidth:1,lineStyle:0,axisLabelVisible:!0,title:"Liq. Price"});L.current.push(v)}const b=parseFloat(e.tpPrice);if(!isNaN(b)&&b>0){const v=c.current.createPriceLine({price:b,color:"#fe445c",lineWidth:1,lineStyle:1,axisLabelVisible:!0,title:"TP"});L.current.push(v)}const w=parseFloat(e.slPrice);if(!isNaN(w)&&w>0){const v=c.current.createPriceLine({price:w,color:"#fe445c",lineWidth:1,lineStyle:1,axisLabelVisible:!0,title:"SL"});L.current.push(v)}}))},[d,u,n,l]);const D=u.find(e=>e.symbol===n||e.symbol===B(I(n)));return t.jsxs(M,{style:{position:"relative",width:"100%",height:`${i}px`,minHeight:`${i}px`},children:[t.jsx(M,{ref:f,style:{width:"100%",height:"100%",cursor:`url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><line x1="8" y1="0" x2="8" y2="16" stroke="%23808080" stroke-width="1"/><line x1="0" y1="8" x2="16" y2="8" stroke="%23808080" stroke-width="1"/></svg>') 8 8, crosshair`}}),t.jsx(Z,{gap:4,p:4,style:{position:"absolute",top:8,left:8,zIndex:10,background:"var(--mantine-color-body)",borderRadius:"var(--mantine-radius-xl)",border:"1px solid var(--mantine-color-default-border)",boxShadow:"var(--mantine-shadow-md)",pointerEvents:"auto"},children:(s.availableIntervals||["1m","5m","15m","1h","4h","1d"]).map(e=>t.jsx(Y,{size:"compact-xs",variant:a===e?"filled":"subtle",color:a===e?"dark.6":"gray",onClick:()=>s.onIntervalChange&&s.onIntervalChange(e),style:{fontSize:"var(--mantine-font-size-xxs)",fontWeight:700,borderRadius:"var(--mantine-radius-xl)",minWidth:"32px",padding:"0 4px"},children:e},e))}),t.jsx(M,{style:{position:"absolute",top:60,left:8,zIndex:10,pointerEvents:"auto"},children:t.jsx(Q,{label:h?"Cancel Draw":"Draw Trendline",position:"right",children:t.jsx(ie,{onClick:()=>O(!h),size:"lg",radius:"xl",variant:h?"filled":"outline",color:h?"blue":"gray",style:{boxShadow:"var(--mantine-shadow-md)",borderWidth:"2px",transform:h?"scale(1.1)":"none",transition:"transform 0.1s ease"},children:h?t.jsx(ge,{size:18}):t.jsx(Se,{size:18})})})}),D&&s.onClosePosition&&S!==null&&S>=0&&S<=i&&t.jsxs(Z,{gap:8,align:"center",style:{position:"absolute",top:S,left:8,zIndex:10,transform:"translateY(-50%)",pointerEvents:"auto"},children:[T&&t.jsxs(M,{px:6,py:2,style:{fontSize:"var(--fz-xxs)",fontWeight:700,backgroundColor:(D.side==="long"?T.price>=D.entryPrice:T.price<=D.entryPrice)?"var(--green)":"var(--red)",color:"var(--mantine-color-white)",borderRadius:"var(--mantine-radius-xs)"},children:["PNL ",(()=>{const e=T.price,p=parseFloat(D.entryPrice),g=parseFloat(D.quantity),b=D.side==="long"?(e-p)*g:(p-e)*g;return`${b>=0?"+":""}${b.toFixed(2)}`})()]}),t.jsx(Q,{label:"Open Position Close Modal",position:"bottom",withArrow:!0,children:t.jsx(Y,{size:"compact-xs",color:"var(--red)",variant:"filled",onClick:e=>{e.stopPropagation(),s.onClosePosition&&s.onClosePosition(D)},style:{fontSize:"var(--fz-xxs)",fontWeight:700,boxShadow:"var(--mantine-shadow-md)",textTransform:"uppercase"},children:"Close Pos"})})]})]})}const ze=r.memo(we);function je({symbol:s,market:n="futures"}){const[i,a]=r.useState(null),[l,d]=r.useState(null),[u,y]=r.useState("gray"),f=te(n,s);return r.useEffect(()=>{f&&(a(f.price),d(f.open))},[f]),r.useEffect(()=>{i===null||l===null||(i>l?y("var(--green)"):i<l?y("var(--red)"):y("dimmed"))},[i,l]),i?t.jsx(A,{component:"span",fw:750,c:u,style:{fontSize:"1.6rem",lineHeight:1},children:i<.1?i.toFixed(6):i<1?i.toFixed(4):i.toFixed(2)}):null}function Ae({symbol:s,market:n,depth:i=50}){const[a,l]=r.useState([]),[d,u]=r.useState([]),[y,f]=r.useState("connecting"),[o,c]=r.useState(null),j=r.useRef(0);r.useEffect(()=>{if(!s)return;l([]),u([]),c(null),f("connecting");const S=H.replace(/^http/,"ws"),P=n==="futures"?"/ws/futures-depth":"/ws/spot-depth",z=n==="futures"?s.includes("_")?s:s.replace(/(USDT|USDC)$/i,"_$1"):s.replace("_","");let x=!1,m=null,V=0;const I=()=>{if(!x)try{m=new WebSocket(`${S}${P}`),m.onopen=()=>{if(x){try{m?.close()}catch{}return}f("open"),V=0;try{m?.send(JSON.stringify({type:"sub",symbol:z,depth:i}))}catch{}};let B=null,T=null;const _=setInterval(()=>{(B||T)&&(B&&l(B),T&&u(T),B=null,T=null)},500);m.onmessage=U=>{try{if(x)return;const L=JSON.parse(U.data);L?.type==="depth"&&L?.symbol===z&&Array.isArray(L?.bids)&&Array.isArray(L?.asks)&&(j.current=Date.now(),B=L.bids,T=L.asks)}catch{}},m.onerror=()=>{x||(f("error"),c("Orderbook connection error"))},m.onclose=()=>{clearInterval(_),!x&&(f("closed"),setTimeout(I,Math.min(1500*Math.max(1,++V),8e3)))}}catch(B){f("error"),c(B?.message??"Orderbook init error"),setTimeout(I,Math.min(1500*Math.max(1,++V),8e3))}};return I(),()=>{if(x=!0,m&&m.readyState===WebSocket.OPEN){try{m.send(JSON.stringify({type:"unsub",symbol:z}))}catch{}try{m.close()}catch{}}}},[s,n,i]);const C=r.useMemo(()=>{const S=[],P=[];let z=0;for(const[,x]of a)z+=x,S.push(z);z=0;for(const[,x]of d)z+=x,P.push(z);return{bidTotals:S,askTotals:P}},[a,d]),h=S=>Number.isFinite(S)?S.toString():"-",O=r.useMemo(()=>d.slice().reverse(),[d]),E=r.useMemo(()=>C.askTotals.slice().reverse(),[C]);return t.jsxs(M,{p:"sm",style:{overflowX:"hidden"},children:[o&&t.jsx(A,{color:"red",size:"sm",mb:"xs",children:o}),y==="connecting"&&t.jsx(A,{c:"dimmed",size:"sm",mb:"xs",children:"Connecting..."}),t.jsxs(G,{cols:3,spacing:4,mb:8,style:{position:"sticky",top:0,backgroundColor:"transparent",zIndex:1},children:[t.jsx(A,{size:"sm",c:"dimmed",fw:500,children:"Price"}),t.jsx(A,{size:"sm",c:"dimmed",fw:500,children:"Size"}),t.jsx(A,{size:"sm",c:"dimmed",fw:500,children:"Total"})]}),t.jsx(G,{cols:3,spacing:4,children:O.map((S,P)=>t.jsxs(M,{style:{display:"contents"},children:[t.jsx(A,{size:"xs",color:"var(--red)",fw:500,children:h(S[0])}),t.jsx(A,{size:"xs",children:h(S[1])}),t.jsx(A,{size:"xs",c:"dimmed",children:h(E[P])})]},`a-${P}`))}),t.jsx(M,{py:3,my:4,children:t.jsx(je,{symbol:s,market:n})}),t.jsx(G,{cols:3,spacing:4,children:a.map((S,P)=>t.jsxs(M,{style:{display:"contents"},children:[t.jsx(A,{size:"xs",color:"var(--green)",fw:500,children:h(S[0])}),t.jsx(A,{size:"xs",children:h(S[1])}),t.jsx(A,{size:"xs",c:"dimmed",children:h(C.bidTotals[P])})]},`b-${P}`))})]})}const ee=["1m","5m","15m","30m","1h","2h","4h","6h","1d","2d","1w"];function Le({symbol:s,market:n,defaultInterval:i="1m"}){const[a,l]=r.useState(["1m","5m","1h","1d"]),[d,u]=r.useState(i),[y,f]=r.useState(!1);return r.useEffect(()=>{let o=!1;return f(!0),(async()=>{try{const C=await(await fetch(`${H}/api/markets/${n==="futures"?"futures/intervals":"spot/intervals"}?symbol=${s}`)).json().catch(()=>({}));if(o)return;const h=Array.isArray(C?.intervals)?C.intervals.filter(O=>ee.includes(O)):["1m","5m","1h","1d"];l(h),h.includes(d)||u(h[0]??"1m")}catch{if(o)return;l(["1m","5m","1h","1d"])}finally{o||f(!1)}})(),()=>{o=!0}},[s,n,d]),{availableIntervals:a,interval:d,setInterval:u,loading:y,allIntervals:ee}}function Ce({value:s,onChange:n}){return t.jsx(M,{py:"xs",mb:"lg",children:t.jsx(oe,{value:s,onChange:n,step:1,min:0,max:100,label:i=>`${i}%`,marks:[{value:0,label:"0%"},{value:25,label:"25%"},{value:50,label:"50%"},{value:75,label:"75%"},{value:100,label:"100%"}],styles:{markLabel:{fontSize:"var(--mantine-font-size-xxs)",marginTop:"var(--mantine-spacing-xs)"},thumb:{borderWidth:2,padding:3}}})})}function $e({opened:s,onClose:n,currentSide:i,asset:a,onTransferred:l}){const[d,u]=r.useState("to-other"),[y,f]=r.useState(""),[o,c]=r.useState(!1),[j,C]=r.useState(0),h=i==="spot"?"futures":"spot",{spotAvailable:O,futuresAvailable:E}=fe(),P=parseFloat((d==="to-other"?i:h)==="spot"?O?.[a]||"0":E?.[a]||"0");r.useEffect(()=>{s&&(f(""),u("to-other"),C(0))},[s]);const z=m=>{C(m),f(m===100?P.toString():(P*m/100).toFixed(6).replace(/\.?0+$/,""))},x=async()=>{if(!(!y||Number(y)<=0)){c(!0);try{const m=localStorage.getItem("accessToken"),V=d==="to-other"?i:h,I=d==="to-other"?h:i;if(!(await fetch(`${H}/api/user/transfer`,{method:"POST",headers:{"Content-Type":"application/json",...m?{Authorization:`Bearer ${m}`}:{}},credentials:"include",body:JSON.stringify({asset:a,from:V,to:I,amount:y})})).ok)return;l&&l(),n()}finally{c(!1)}}};return t.jsxs(ce,{opened:s,onClose:n,title:`Transfer ${a}`,centered:!0,lockScroll:!1,children:[t.jsx(J,{value:d,onChange:m=>{u(m),f(""),C(0)},variant:"pills",radius:"md",mb:"sm",children:t.jsxs(J.List,{grow:!0,children:[t.jsxs(J.Tab,{value:"to-other",style:{textTransform:"capitalize"},children:[i," → ",h]}),t.jsxs(J.Tab,{value:"from-other",style:{textTransform:"capitalize"},children:[h," → ",i]})]})}),t.jsxs(A,{size:"xs",c:"dimmed",ta:"right",mb:4,children:["Available: ",t.jsxs(A,{component:"span",fw:600,style:{color:"var(--foreground)"},children:[Number(P).toLocaleString(void 0,{maximumFractionDigits:4})," ",a]})]}),t.jsx(ae,{label:"Amount",placeholder:"0.00",value:y,onChange:m=>{f(m.currentTarget.value),C(0)},mb:"xs"}),t.jsx(Ce,{value:j,onChange:z}),t.jsx(le,{justify:"right",mt:"md",children:t.jsx(Y,{onClick:x,loading:o,disabled:!y||Number(y)<=0,children:"Transfer"})})]})}const Re=r.memo(({data:s,columns:n,emptyMessage:i,maxHeight:a="430px"})=>t.jsx(M,{style:{height:a,overflowY:"auto"},children:t.jsx(M,{style:{overflowX:"auto",flex:1},px:"xs",children:t.jsxs(F,{verticalSpacing:"xs",horizontalSpacing:4,highlightOnHover:!0,fs:"sm",withRowBorders:!1,children:[t.jsx(F.Thead,{bg:"var(--bg-2)",style:{position:"sticky",top:0,zIndex:2},children:t.jsx(F.Tr,{children:n.map(l=>{const d=typeof l=="string"?l:l.label;return t.jsx(F.Th,{c:"dimmed",fw:600,py:10,style:{whiteSpace:"nowrap"},children:d},d)})})}),t.jsx(F.Tbody,{style:{verticalAlign:"middle"},children:s.length===0?t.jsx(F.Tr,{children:t.jsx(F.Td,{py:16,ta:"center",c:"dimmed",colSpan:n.length,children:i})}):s.map((l,d)=>t.jsx(F.Tr,{children:n.map(u=>{const y=typeof u=="string"?u:u.key,f=typeof u=="string"?u:u.label;return typeof u!="string"&&u.render?t.jsx(F.Td,{children:u.render(l)},f):t.jsx(F.Td,{children:l[y]??"-"},f)})},l.id||l._id||d))})]})})}));function Ne(s,n,i){const[a,l]=r.useState(null),[d,u]=r.useState(!1);return r.useEffect(()=>{if(!n||!i)return;l(null),u(!0);const y=H.replace(/^http/,"ws"),f=s==="spot"?"/ws/spot-24h":"/ws/futures-24h",o=new WebSocket(`${y}${f}`),c=s==="spot"?`${n}${i}`:`${n}_${i}`;let j=!1;return o.onopen=()=>{j||o.send(JSON.stringify({type:"sub",symbol:c}))},o.onmessage=C=>{try{const h=JSON.parse(C.data);!j&&h?.type==="stats"&&h?.symbol===c&&(l(h.data),u(!1))}catch{}},o.onclose=()=>{j||u(!1)},o.onerror=()=>{j||u(!1)},()=>{j=!0,(o.readyState===WebSocket.OPEN||o.readyState===WebSocket.CONNECTING)&&o.close()}},[s,n,i]),{stats:a,loading:d}}export{je as B,Re as D,Ae as O,ze as P,Ce as T,Le as a,$e as b,Ne as u};
